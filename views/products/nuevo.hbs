  <h1>Nuevo</h1>

  <form action="/nuevo" method="post" enctype="multipart/form-data">
    <label>Nombre del producto</label>
    <input type="text" name="name">
    <br>
    <label>Descripción de tu producto</label>
    <textarea name="desc" type="text"></textarea>
    <br>
    <label>Precio de tu producto</label>
    <input type="number" name="price">
    <br>
    <label>Stock</label>
    <input maxlength= "2" type="number" name="stock">
    <br>
    <label>Galería de fotos</label>
    <input multiple type="file" name="photos">
    <br>
    <input type="submit">
    <br>
    <br>
    <div id="map" style="width:100%; height:400px;"></div>
    <br>
  </form>

  <script>

		var circle = null;
		var map    = null;
		var marker = null;
		function initMap(){
			var output = document.getElementById("map");

			if(navigator.geolocation){
				console.log("Tu navegador soporta la geolocalización");
			}
			else{
				console.log("Tu navegador NO soporta la geolocalización");
			}

		
			function localizacion(posicion){
				var lat=posicion.coords.latitude;
				var lng=posicion.coords.longitude;

				output.innerHTML = "<p>Latitud:"+lat+"<br>Longitud:"+lng+"</p>";
				var mapProp= {
    			center:new google.maps.LatLng(lat,lng),
    			zoom:15,
				};
				var miUbicacion = {lat,lng};
				var map=new google.maps.Map(document.getElementById("map"),mapProp);
				var marker = new google.maps.Marker({
    			position: miUbicacion,
    			map: map,
    			 draggable: true,
    				animation: google.maps.Animation.DROP,
    			title: 'Me encuentro aqui'
  				});
  				marker.addListener('click', toggleBounce);

  				function toggleBounce() {
				  if (marker.getAnimation() !== null) {
				    marker.setAnimation(null);
				  } else {
				    marker.setAnimation(google.maps.Animation.BOUNCE);
				  }
				}

  				var drawingManager = new google.maps.drawing.DrawingManager({
				drawingControlOptions:{
					drawingModes:["marker","circle"]
				}
			});
			drawingManager.setMap(map);

			google.maps.event.addListener(drawingManager,"overlaycomplete", function(event){
				if(event.type=="circle"){
					
					var center = event.overlay.getCenter();
					circle={
						radius: event.overlay.getRadius(),
						center:{
							lat: center.lat(),
							lng: center.lng()
						},
						overlay:event.overlay
					}
				}
				else if(event.type=="marker"){
					var position= event.overlay.position;
					marker={
						center:{
							lat: position.lat(),
							lng: position.lng()
						}
					}
					var isInRadius = google.maps.geometry.spherical.computeDistanceBetween(position,circle.overlay.getCenter()) <= circle.radius;
					if(isInRadius) return alert("Adentro");
					return alert("Afuera");	
				}
				else{
					console.log("ERROR");
				}
			});

				
			}

			function error(){
				output.innerHTML = "<p>No se pudó obtener tu localización</p>";
			}

			navigator.geolocation.getCurrentPosition(localizacion,error);

			
		}
	</script>
	<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAtU6T9WWG9eobQjPFNkcPAXLwH1QB0aVs&callback=initMap&libraries=drawing"
    async defer></script>